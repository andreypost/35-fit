(self.webpackChunk_35fit=self.webpackChunk_35fit||[]).push([[841],{7187:(e,r,n)=>{"use strict";n.r(r),n.d(r,{default:()=>b});var t=n(3391),o=n(2137),u=n(7757),i=n.n(u),a=n(7294),s=n(4577),l=n(1937),c=n(3349),f=function(){return(f=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e}).apply(this,arguments)},d=function(e){return{loading:null==e,value:e}},v=function(e,r){var n=!e&&!r,t=!!e&&!!r&&e.isEqual(r);return n||t},p=function(e,r,n){var t=function(e){var r=e?e():void 0,n=(0,a.useReducer)((function(e,r){switch(r.type){case"error":return f({},e,{error:r.error,loading:!1,value:void 0});case"reset":return d(r.defaultValue);case"value":return f({},e,{error:void 0,loading:!1,value:r.value});default:return e}}),d(r)),t=n[0],o=n[1],u=function(){var r=e?e():void 0;o({type:"reset",defaultValue:r})},i=function(e){o({type:"error",error:e})},s=function(e){o({type:"value",value:e})};return(0,a.useMemo)((function(){return{error:t.error,loading:t.loading,reset:u,setError:i,setValue:s,value:t.value}}),[t.error,t.loading,u,i,s,t.value])}(),o=t.error,u=t.loading,i=t.reset,s=t.setError,l=t.setValue,c=t.value,p=function(e,r){return function(e,r,n){var t=(0,a.useRef)(e);return(0,a.useEffect)((function(){r(e,t.current)||(t.current=e,n&&n())})),t}(e,v,r)}(r,i);(0,a.useEffect)((function(){if(p.current){if(e){var r=n&&n.snapshotListenOptions?p.current.onSnapshot(n.snapshotListenOptions,l,s):p.current.onSnapshot(l,s);return function(){r()}}p.current.get(n?n.getOptions:void 0).then(l).catch(s)}else l(void 0)}),[p.current]);var h=[c,u,o];return(0,a.useMemo)((function(){return h}),h)},h=n(5929),m=n(5893);function g(e,r){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,r){if(e){if("string"==typeof e)return y(e,r);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?y(e,r):void 0}}(e))||r&&e&&"number"==typeof e.length){n&&(e=n);var t=0,o=function(){};return{s:o,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var u,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,u=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw u}}}}function y(e,r){(null==r||r>e.length)&&(r=e.length);for(var n=0,t=new Array(r);n<r;n++)t[n]=e[n];return t}var x=function(e){var r=e.width,n=e.height,t=e.border,u=(0,a.useRef)(null),s=function(){var e=(0,o.Z)(i().mark((function e(){var r,n,t,o,a,s;return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=u.current,e.next=3,new Promise((function(e){return null==r?void 0:r.toBlob(e,"image/png")}));case 3:n=e.sent,(t=new FormData).append("image",n,"image.png"),o=g(t);try{for(o.s();!(a=o.n()).done;)s=a.value,console.log(s,n)}catch(e){o.e(e)}finally{o.f()}case 8:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,m.jsxs)(m.Fragment,{children:[(0,m.jsx)("canvas",{width:r,height:n,style:{border:t},ref:u,onMouseMove:function(e){var r=u.current,n=null==r?void 0:r.getContext("2d");null==n||n.lineTo(e.clientX,e.clientY),null==n||n.stroke()}}),(0,m.jsx)("input",{type:"button",value:"send blob data",onClick:s})]})};const b=function(){var e=(0,a.useContext)(l.y),r=e.firebase,n=e.auth,u=e.firestore,f=(0,c.F_)(n),d=(0,t.Z)(f,1)[0],v=(0,a.useState)(""),g=(0,t.Z)(v,2),y=g[0],b=g[1],j=function(e,r,n){var t=n?n.idField:void 0,o=n?n.refField:void 0,u=n?n.snapshotOptions:void 0,i=n?n.transform:void 0,s=p(e,r,n),l=s[0],c=s[1],f=s[2],d=[(0,a.useMemo)((function(){return l?l.docs.map((function(e){return function(e,r,n,t,o){if(e.exists){var u=e.data(r);return o&&(u=o(u)),n&&(u[n]=e.id),t&&(u[t]=e.ref),u}}(e,u,t,o,i)})):void 0}),[l,u,t,o,i]),c,f];return(0,a.useMemo)((function(){return d}),d)}(!0,u.collection("messages").orderBy("createdAt"),undefined),w=(0,t.Z)(j,2),F=w[0],S=w[1],O=function(){var e=(0,o.Z)(i().mark((function e(n){return i().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n.preventDefault(),console.log(y),u.collection("messages").add({uid:null==d?void 0:d.uid,displayName:null==d?void 0:d.displayName,photoUrl:null==d?void 0:d.photoURL,text:y,createdAt:r.firestore.FieldValue.serverTimestamp()}),b("");case 4:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}();return S&&h.Z,(0,a.useEffect)((function(){var e,r;console.log((e=2,(r=function r(n){return e+=n,r}).toString=function(){return e},r)(3)(-2)(26))}),[]),(0,m.jsxs)(m.Fragment,{children:[(0,m.jsxs)(s.Z,{children:[(0,m.jsx)(x,{width:"100%",height:"250px",border:"1px solid red"}),(0,m.jsx)(m.Fragment,{})]}),(0,m.jsx)("h1",{children:"Chat"}),(0,m.jsx)("div",{children:null==F?void 0:F.map((function(e){return(0,m.jsxs)(a.Fragment,{children:[(0,m.jsx)("img",{src:e.photoUrl,alt:"",style:{borderRadius:"50%"}}),(0,m.jsxs)("p",{children:[e.text," - ",e.displayName]})]},e.text)}))}),(0,m.jsxs)("form",{action:"",id:"chatForm",onSubmit:O,children:[(0,m.jsx)("textarea",{name:"",id:"",onChange:function(e){return b(e.target.value)},value:y,required:!0}),(0,m.jsx)("button",{type:"submit",children:"send"})]})]})}}}]);
//# sourceMappingURL=841.bundle.js.map